openapi: 3.0.3
info:
  title: SillyTavern API
  description: |
    REST API for SillyTavern, a frontend for AI text generation.

    ## Authentication

    Most API endpoints require authentication via cookies. After logging in, the server will set session cookies that must be included in subsequent requests.

    ## CSRF Protection

    SillyTavern implements CSRF (Cross-Site Request Forgery) protection for all state-changing requests (POST, PUT, DELETE, PATCH).

    To make authenticated requests to protected endpoints:

    1. First, obtain a CSRF token by making a GET request to `/csrf-token`
    2. Include the token in the `X-CSRF-Token` header for all subsequent POST/PUT/DELETE/PATCH requests

    Example:
    ```javascript
    // Step 1: Get CSRF token
    const csrfResponse = await fetch('/csrf-token');
    const { token } = await csrfResponse.json();

    // Step 2: Use token in subsequent requests
    const response = await fetch('/api/characters/create', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': token
      },
      body: JSON.stringify(characterData)
    });
    ```

    Note: If CSRF protection is disabled in the server configuration, the token will have the value "disabled" and is not required for requests.
  version: 1.0.0
servers:
  - url: http://localhost:8000
    description: Local development server
components:
  schemas:
    CsrfToken:
      type: object
      properties:
        token:
          type: string
          description: CSRF token value ("disabled" if CSRF protection is disabled)
      required:
        - token

    User:
      type: object
      properties:
        handle:
          type: string
        name:
          type: string
        created:
          type: string
          format: date-time
        avatar:
          type: string
        password:
          type: boolean

    LoginRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string

    RecoverRequest:
      type: object
      properties:
        username:
          type: string

    CharacterCreateRequest:
      type: object
      properties:
        ch_name:
          type: string
        file_name:
          type: string

    CharacterRenameRequest:
      type: object
      properties:
        avatar_url:
          type: string
        new_name:
          type: string

    CharacterRenameResponse:
      type: object
      properties:
        avatar:
          type: string

    CharacterEditRequest:
      type: object
      properties:
        avatar_url:
          type: string
        ch_name:
          type: string

    CharacterAttributeEditRequest:
      type: object
      properties:
        avatar_url:
          type: string
        field:
          type: string
        value:
          type: string
        ch_name:
          type: string

    CharacterMergeAttributesRequest:
      type: object
      properties:
        avatar:
          type: string

    CharacterDeleteRequest:
      type: object
      properties:
        avatar_url:
          type: string
        delete_chats:
          type: boolean

    CharacterGetRequest:
      type: object
      properties:
        avatar_url:
          type: string

    CharacterChatsRequest:
      type: object
      properties:
        avatar_url:
          type: string
        simple:
          type: boolean
        metadata:
          type: boolean

    CharacterImportRequest:
      type: object
      properties:
        file_type:
          type: string
          enum: [yaml, yml, json, png, charx, byaf]
        preserved_name:
          type: string

    CharacterDuplicateRequest:
      type: object
      properties:
        avatar_url:
          type: string

    CharacterDuplicateResponse:
      type: object
      properties:
        path:
          type: string

    CharacterExportRequest:
      type: object
      properties:
        format:
          type: string
          enum: [png, json]
        avatar_url:
          type: string

    ChatSaveRequest:
      type: object
      properties:
        ch_name:
          type: string
        file_name:
          type: string
        chat:
          type: array
          items:
            type: object

    ChatGetRequest:
      type: object
      properties:
        ch_name:
          type: string
        file_name:
          type: string
        continuation:
          type: boolean

    ChatRenameRequest:
      type: object
      properties:
        old_avatar_name:
          type: string
        new_avatar_name:
          type: string
        old_file_name:
          type: string
        new_file_name:
          type: string

    ChatDeleteRequest:
      type: object
      properties:
        ch_name:
          type: string
        file_name:
          type: string

    ChatExportRequest:
      type: object
      properties:
        ch_name:
          type: string
        file_name:
          type: string
        export_format:
          type: string
          enum: [txt, html, csv, json, png]
        include_metadata:
          type: boolean

    GroupChatImportResponse:
      type: object
      properties:
        res:
          type: string

    GroupChatGetRequest:
      type: object
      properties:
        id:
          type: string

    GroupChatDeleteRequest:
      type: object
      properties:
        id:
          type: string

    GroupChatSaveRequest:
      type: object
      properties:
        id:
          type: string
        chat:
          type: array
          items:
            type: object

    GroupChatSaveResponse:
      type: object
      properties:
        ok:
          type: boolean

    ChatImportRequest:
      type: object
      properties:
        file_type:
          type: string
          enum: [json, jsonl]
        avatar_url:
          type: string
        character_name:
          type: string
        user_name:
          type: string

    ChatImportResponse:
      type: object
      properties:
        res:
          type: boolean
        fileNames:
          type: array
          items:
            type: string

    ChatSearchRequest:
      type: object
      properties:
        query:
          type: string
        avatar_url:
          type: string
        group_id:
          type: string

    ChatRecentRequest:
      type: object
      properties:
        max:
          type: integer
        metadata:
          type: boolean

    SettingsSaveResponse:
      type: object
      properties:
        result:
          type: string

    AvatarDeleteRequest:
      type: object
      properties:
        file:
          type: string

    ThemeSaveRequest:
      type: object
      properties:
        name:
          type: string
        theme:
          type: object

    BackgroundDeleteRequest:
      type: object
      properties:
        filename:
          type: string

    BackgroundRenameRequest:
      type: object
      properties:
        old_file:
          type: string
        new_file:
          type: string

    BackgroundUploadRequest:
      type: object
      properties:
        name:
          type: string

    ImageUploadRequest:
      type: object
      properties:
        category:
          type: string

    ImageUploadResponse:
      type: object
      properties:
        path:
          type: string

    ImageListResponse:
      type: array
      items:
        type: string

    PresetsSaveRequest:
      type: object
      properties:
        name:
          type: string
        preset:
          type: object
        api:
          type: string

    PresetsDeleteRequest:
      type: object
      properties:
        name:
          type: string
        api:
          type: string

    PresetsSelectRequest:
      type: object
      properties:
        name:
          type: string
        api:
          type: string

    WorldInfoGetRequest:
      type: object
      properties:
        ch_name:
          type: string

    WorldInfoDeleteRequest:
      type: object
      properties:
        uid:
          type: string
        ch_name:
          type: string

    WorldInfoSaveRequest:
      type: object
      properties:
        world_info:
          type: array
          items:
            type: object
        ch_name:
          type: string

    WorldInfoExportRequest:
      type: object
      properties:
        ch_name:
          type: string

    WorldInfoExportResponse:
      type: object
      properties:
        world_info:
          type: array
          items:
            type: object

    StatsUpdateRequest:
      type: object
      properties:
        type:
          type: string
        data:
          type: object

    ExtensionToggleRequest:
      type: object
      properties:
        name:
          type: string
        state:
          type: boolean

    FileListRequest:
      type: object
      properties:
        path:
          type: string

    FileDeleteRequest:
      type: object
      properties:
        path:
          type: string

    FileRenameRequest:
      type: object
      properties:
        old_path:
          type: string
        new_path:
          type: string

    FileCopyRequest:
      type: object
      properties:
        source:
          type: string
        destination:
          type: string

    FileMoveRequest:
      type: object
      properties:
        source:
          type: string
        destination:
          type: string

    TokenizerRequest:
      type: object
      properties:
        text:
          type: string

    TokenizerResponse:
      type: object
      properties:
        token_count:
          type: integer

paths:
  # CSRF Token Endpoint
  /csrf-token:
    get:
      summary: Get CSRF token
      description: |
        Retrieve a CSRF token for protected requests.

        This endpoint returns a CSRF token that must be included in the `X-CSRF-Token` header
        for all state-changing requests (POST, PUT, DELETE, PATCH) to prevent Cross-Site Request Forgery attacks.

        If CSRF protection is disabled on the server, the token value will be "disabled".
      responses:
        "200":
          description: CSRF token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CsrfToken"
        "500":
          description: Server error

  # Users Public Endpoints
  /api/users/list:
    post:
      summary: List all users
      description: Get a list of all enabled users
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "204":
          description: No content (discreet login mode)
  /api/users/login:
    post:
      summary: User login
      description: |
        Authenticate a user. On successful authentication, the server sets session cookies
        that must be included in subsequent requests to authenticated endpoints.

        After logging in, you should:
        1. Store the session cookies from the response
        2. Include these cookies in all future requests
        3. Obtain a CSRF token from `/csrf-token` for state-changing requests
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successful
        "401":
          description: Invalid credentials
        "429":
          description: Too many requests
  /api/users/recover:
    post:
      summary: Password recovery
      description: Initiate password recovery process
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecoverRequest"
      responses:
        "200":
          description: Recovery initiated
        "404":
          description: User not found
        "429":
          description: Too many requests

  # Characters Endpoints
  /api/characters/create:
    post:
      summary: Create a new character
      description: |
        Create a new character with provided data.

        Note: This endpoint requires:
        1. Valid session cookies (obtained via login)
        2. CSRF token in the `X-CSRF-Token` header
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/CharacterCreateRequest"
      responses:
        "200":
          description: Character created successfully
          content:
            text/plain:
              schema:
                type: string
                description: Avatar filename
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/characters/rename:
    post:
      summary: Rename a character
      description: Rename an existing character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterRenameRequest"
      responses:
        "200":
          description: Character renamed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CharacterRenameResponse"
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/characters/edit:
    post:
      summary: Edit a character
      description: Edit an existing character's data
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/CharacterEditRequest"
      responses:
        "200":
          description: Character edited successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/characters/edit-attribute:
    post:
      summary: Edit a character attribute
      description: Edit a specific attribute of a character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterAttributeEditRequest"
      responses:
        "200":
          description: Attribute edited successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/characters/merge-attributes:
    post:
      summary: Merge character attributes
      description: Merge multiple attributes with a character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterMergeAttributesRequest"
      responses:
        "200":
          description: Attributes merged successfully
        "400":
          description: Bad request or validation failed
        "500":
          description: Server error
  /api/characters/delete:
    post:
      summary: Delete a character
      description: Delete a character and optionally its chats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterDeleteRequest"
      responses:
        "200":
          description: Character deleted successfully
        "400":
          description: Bad request
        "403":
          description: Forbidden (malicious filename)
        "500":
          description: Server error
  /api/characters/all:
    post:
      summary: Get all characters
      description: Retrieve a list of all characters
      responses:
        "200":
          description: List of characters
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Character properties
        "500":
          description: Server error
  /api/characters/get:
    post:
      summary: Get a specific character
      description: Retrieve detailed information about a specific character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterGetRequest"
      responses:
        "200":
          description: Character data
          content:
            application/json:
              schema:
                type: object
                # Character properties
        "400":
          description: Bad request
        "404":
          description: Character not found
        "500":
          description: Server error
  /api/characters/chats:
    post:
      summary: Get character chats
      description: Retrieve a list of chats for a specific character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterChatsRequest"
      responses:
        "200":
          description: List of chats
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Chat properties
        "400":
          description: Bad request
  /api/characters/import:
    post:
      summary: Import a character
      description: Import a character from various formats
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/CharacterImportRequest"
      responses:
        "200":
          description: Character imported successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  file_name:
                    type: string
        "400":
          description: Bad request
  /api/characters/duplicate:
    post:
      summary: Duplicate a character
      description: Create a copy of an existing character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterDuplicateRequest"
      responses:
        "200":
          description: Character duplicated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CharacterDuplicateResponse"
        "400":
          description: Bad request
        "404":
          description: Character not found
  /api/characters/export:
    post:
      summary: Export a character
      description: Export a character in specified format
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CharacterExportRequest"
      responses:
        "200":
          description: Character exported successfully
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "400":
          description: Bad request
        "404":
          description: Character not found
        "500":
          description: Server error

  # Chats Endpoints
  /api/chats/save:
    post:
      summary: Save a chat
      description: Save a chat for a character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatSaveRequest"
      responses:
        "200":
          description: Chat saved successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/chats/get:
    post:
      summary: Get a chat
      description: Retrieve a specific chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatGetRequest"
      responses:
        "200":
          description: Chat data
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Message properties
        "400":
          description: Bad request
        "404":
          description: Chat not found
        "500":
          description: Server error
  /api/chats/rename:
    post:
      summary: Rename a chat
      description: Rename an existing chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatRenameRequest"
      responses:
        "200":
          description: Chat renamed successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/chats/delete:
    post:
      summary: Delete a chat
      description: Delete a specific chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatDeleteRequest"
      responses:
        "200":
          description: Chat deleted successfully
        "400":
          description: Bad request
        "404":
          description: Chat not found
        "500":
          description: Server error
  /api/chats/export:
    post:
      summary: Export a chat
      description: Export a chat in a specific format
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatExportRequest"
      responses:
        "200":
          description: Chat exported successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: string
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/chats/group/import:
    post:
      summary: Import a group chat
      description: Import a group chat from a file
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "200":
          description: Group chat imported successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupChatImportResponse"
        "400":
          description: Bad request
  /api/chats/group/get:
    post:
      summary: Get a group chat
      description: Retrieve a specific group chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupChatGetRequest"
      responses:
        "200":
          description: Group chat data
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Message properties
        "400":
          description: Bad request
  /api/chats/group/delete:
    post:
      summary: Delete a group chat
      description: Delete a specific group chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupChatDeleteRequest"
      responses:
        "200":
          description: Group chat deleted successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupChatSaveResponse"
        "400":
          description: Bad request
  /api/chats/group/save:
    post:
      summary: Save a group chat
      description: Save a group chat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupChatSaveRequest"
      responses:
        "200":
          description: Group chat saved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupChatSaveResponse"
        "400":
          description: Bad request
  /api/chats/import:
    post:
      summary: Import a chat
      description: Import a chat for a character from various formats
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/ChatImportRequest"
      responses:
        "200":
          description: Chat imported successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChatImportResponse"
        "400":
          description: Bad request
  /api/chats/search:
    post:
      summary: Search chats
      description: Search for chats containing specific text
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatSearchRequest"
      responses:
        "200":
          description: Search results
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Chat search result properties
        "500":
          description: Server error
  /api/chats/recent:
    post:
      summary: Get recent chats
      description: Retrieve a list of recently modified chats
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ChatRecentRequest"
      responses:
        "200":
          description: List of recent chats
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Recent chat properties
        "500":
          description: Server error

  # Settings Endpoints
  /api/settings/save:
    post:
      summary: Save settings
      description: Save user settings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              # Settings properties
      responses:
        "200":
          description: Settings saved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SettingsSaveResponse"
        "500":
          description: Server error
  /api/settings/get:
    post:
      summary: Get settings
      description: Retrieve user settings
      responses:
        "200":
          description: User settings
          content:
            application/json:
              schema:
                type: object
                # Settings properties
        "500":
          description: Server error

  # Avatars Endpoints
  /api/avatars/get:
    post:
      summary: Get user avatars
      description: Retrieve a list of user avatars
      responses:
        "200":
          description: List of avatars
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Avatar properties
        "404":
          description: Avatars directory not found
  /api/avatars/delete:
    post:
      summary: Delete user avatar
      description: Delete a specific user avatar
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AvatarDeleteRequest"
      responses:
        "200":
          description: Avatar deleted successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/avatars/upload:
    post:
      summary: Upload user avatar
      description: Upload a new user avatar
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  format: binary
      responses:
        "200":
          description: Avatar uploaded successfully
        "400":
          description: Bad request
        "500":
          description: Server error

  # Themes Endpoints
  /api/themes/save:
    post:
      summary: Save theme
      description: Save a user theme
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThemeSaveRequest"
      responses:
        "200":
          description: Theme saved successfully
        "400":
          description: Bad request
        "500":
          description: Server error

  # Backgrounds Endpoints
  /api/backgrounds/all:
    post:
      summary: Get all backgrounds
      description: Retrieve a list of all backgrounds
      responses:
        "200":
          description: List of backgrounds
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Background properties
        "404":
          description: Backgrounds directory not found
        "500":
          description: Server error
  /api/backgrounds/delete:
    post:
      summary: Delete background
      description: Delete a specific background
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BackgroundDeleteRequest"
      responses:
        "200":
          description: Background deleted successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/backgrounds/rename:
    post:
      summary: Rename background
      description: Rename a specific background
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BackgroundRenameRequest"
      responses:
        "200":
          description: Background renamed successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/backgrounds/upload:
    post:
      summary: Upload background
      description: Upload a new background
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/BackgroundUploadRequest"
      responses:
        "200":
          description: Background uploaded successfully
        "400":
          description: Bad request
        "500":
          description: Server error

  # Images Endpoints
  /api/images/upload:
    post:
      summary: Upload image
      description: Upload a new image
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/ImageUploadRequest"
      responses:
        "200":
          description: Image uploaded successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ImageUploadResponse"
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/images/list/{folder}:
    post:
      summary: List images
      description: Retrieve a list of images in a specific folder
      parameters:
        - name: folder
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of images
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ImageListResponse"
        "500":
          description: Server error

  # Presets Endpoints
  /api/presets/all:
    post:
      summary: Get all presets
      description: Retrieve all presets for different backends
      responses:
        "200":
          description: Presets data
          content:
            application/json:
              schema:
                type: object
                properties:
                  novelai:
                    type: array
                    items:
                      type: object
                  openai:
                    type: array
                    items:
                      type: object
                  textgen:
                    type: array
                    items:
                      type: object
        "500":
          description: Server error
  /api/presets/save:
    post:
      summary: Save preset
      description: Save a preset for a specific backend
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PresetsSaveRequest"
      responses:
        "200":
          description: Preset saved successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/presets/delete:
    post:
      summary: Delete preset
      description: Delete a specific preset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PresetsDeleteRequest"
      responses:
        "200":
          description: Preset deleted successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/presets/select:
    post:
      summary: Select preset
      description: Select a preset for use
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PresetsSelectRequest"
      responses:
        "200":
          description: Preset selected successfully
          content:
            application/json:
              schema:
                type: object
                # Preset data
        "400":
          description: Bad request
        "404":
          description: Preset not found
        "500":
          description: Server error

  # World Info Endpoints
  /api/worldinfo/get:
    post:
      summary: Get world info
      description: Retrieve world info entries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WorldInfoGetRequest"
      responses:
        "200":
          description: World info entries
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # World info entry properties
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/worldinfo/delete:
    post:
      summary: Delete world info
      description: Delete a world info entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WorldInfoDeleteRequest"
      responses:
        "200":
          description: World info entry deleted successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/worldinfo/save:
    post:
      summary: Save world info
      description: Save a world info entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WorldInfoSaveRequest"
      responses:
        "200":
          description: World info entry saved successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/worldinfo/import:
    post:
      summary: Import world info
      description: Import world info entries from a file
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                ch_name:
                  type: string
      responses:
        "200":
          description: World info imported successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/worldinfo/export:
    post:
      summary: Export world info
      description: Export world info entries to a file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WorldInfoExportRequest"
      responses:
        "200":
          description: World info exported successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorldInfoExportResponse"
        "400":
          description: Bad request
        "500":
          description: Server error

  # Stats Endpoints
  /api/stats/get:
    post:
      summary: Get stats
      description: Retrieve usage statistics
      responses:
        "200":
          description: Statistics data
          content:
            application/json:
              schema:
                type: object
                # Stats properties
        "500":
          description: Server error
  /api/stats/recreate:
    post:
      summary: Recreate stats
      description: Recreate statistics database
      responses:
        "200":
          description: Stats recreated successfully
        "500":
          description: Server error
  /api/stats/update:
    post:
      summary: Update stats
      description: Update statistics with new data
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StatsUpdateRequest"
      responses:
        "200":
          description: Stats updated successfully
        "400":
          description: Bad request
        "500":
          description: Server error

  # Extensions Endpoints
  /api/extensions/list:
    get:
      summary: List extensions
      description: Retrieve a list of available extensions
      responses:
        "200":
          description: List of extensions
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # Extension properties
        "500":
          description: Server error
  /api/extensions/toggle:
    post:
      summary: Toggle extension
      description: Enable or disable an extension
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExtensionToggleRequest"
      responses:
        "200":
          description: Extension toggled successfully
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/extensions/reload:
    post:
      summary: Reload extensions
      description: Reload all extensions
      responses:
        "200":
          description: Extensions reloaded successfully
        "500":
          description: Server error

  # Files Endpoints
  /api/files/list:
    post:
      summary: List files
      description: Retrieve a list of files in a directory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileListRequest"
      responses:
        "200":
          description: List of files
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  # File properties
        "400":
          description: Bad request
        "500":
          description: Server error
  /api/files/delete:
    post:
      summary: Delete file
      description: Delete a specific file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileDeleteRequest"
      responses:
        "200":
          description: File deleted successfully
        "400":
          description: Bad request
        "403":
          description: Forbidden
        "500":
          description: Server error
  /api/files/rename:
    post:
      summary: Rename file
      description: Rename a specific file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileRenameRequest"
      responses:
        "200":
          description: File renamed successfully
        "400":
          description: Bad request
        "403":
          description: Forbidden
        "500":
          description: Server error
  /api/files/copy:
    post:
      summary: Copy file
      description: Copy a specific file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileCopyRequest"
      responses:
        "200":
          description: File copied successfully
        "400":
          description: Bad request
        "403":
          description: Forbidden
        "500":
          description: Server error
  /api/files/move:
    post:
      summary: Move file
      description: Move a specific file
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileMoveRequest"
      responses:
        "200":
          description: File moved successfully
        "400":
          description: Bad request
        "403":
          description: Forbidden
        "500":
          description: Server error

  # Tokenizers Endpoints
  /api/tokenizers/gpt:
    post:
      summary: GPT tokenizer
      description: Tokenize text using GPT tokenizer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TokenizerRequest"
      responses:
        "200":
          description: Tokenization result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenizerResponse"
        "400":
          description: Bad request
        "500":
          description: Server error

  # Ping Endpoint
  /api/ping:
    post:
      summary: Ping server
      description: Check if server is responsive
      parameters:
        - name: extend
          in: query
          schema:
            type: boolean
      responses:
        "204":
          description: Server is responsive
